candleChart(NDAQ, theme='white', TA=c(addBBands()), subset='20081001::20081201')
candleChart(NDAQ, theme='red', TA=c(addBBands()), subset='20081001::20081201')
candleChart(NDAQ, theme='black', TA=c(addBBands()), subset='20081001::20081201')
candleChart(NDAQ, theme='white', TA=c(addBBands()), subset='20081001::20081201')
candleChart(NDAQ, theme='white',up.col='green',dn.col='red' , TA=c(addBBands()), subset='20081001::20081201')
candleChart(NDAQ, theme='white',up.col='green',dn.col='red' , TA=c(addBBands(), addVo()), subset='20081001::20081201')
?"candleChart"
?addBands
?addBBands
?bollingerBands
?"candleChart"
chart_Series("NDAQ")
chart_Series(NDAQ)
candleChart(NDAQ, theme='white',up.col='green',dn.col='red' , TA=c(addBBands()), yrange=c(15,45), subset='20081001::20081201')
barChart(NDAQ, TA=c(addWPR(),addVo()), subset='20130601::20131201')
barChart(NDAQ, TA=c(addWPR(),addVo()), subset='20130601::20131201')
barChart(NDAQ, TA=c(addWPR(),addVo()), subset='20130801::20131201')
barChart(NDAQ, TA=c(addWPR(),addVo()), subset='20130801::20131201')
barChart(NDAQ, TA=c(addWPR(),addVo()), subset='20130101::20131201')
barChart(NDAQ, TA=c(addWPR(),addVo()), subset='20130501::20131201')
barChart(NDAQ, TA=c(addWPR(),addVo()), subset='20130801::20131201')
barChart(NDAQ, TA=c(addWPR(),addVo()), subset='20130801::20131201')
summary(ndaq)
str(ndaq)
head(ndaq)
library(rjson)
library(devtools)
library(verisr)
library(ggplot2)
library(plyr)
library(tidyr)
library(dplyr)
library(scales)
setwd("E:/Documents/School/Winter2016/srt411/assignment1/pt1/")
newjsondir <- 'newData/VCDB-master/data/json'
newvcdb <- json2veris(newjsondir)
oldjsondir <- 'ch07/data/vcdb'
oldvcdb <- json2veris(oldjsondir)
newActors <- getenum(newvcdb, "actor", add.n=TRUE, add.freq=TRUE)
oldActors <- getenum(oldvcdb, "actor", add.n=TRUE, add.freq=TRUE)
newVerisplot <- function(newvcdb, field) {
# get the data.frame for the field with frequency
localdf <- getenum(newvcdb, field, add.freq=T)
# now let's take first 5 fields in the data frame.
localdf <- localdf[c(1:5), ]
# add a label to the data.frame
localdf$lab <- paste(round(localdf$freq*100, 0), "%", sep="")
# now we can create a ggplot2 instance
gg <- ggplot(localdf, aes(x=enum, y=freq, label=lab))
gg <- gg + geom_bar(stat="identity", fill="steelblue")
# add in text, adjusted to the end of the bar
gg <- gg + geom_text(hjust=-0.1, size=3)
# flip the axes and add in a title
gg <- gg + coord_flip() + ggtitle(field)
# remove axes labels and add bw theme
gg <- gg + xlab("") + ylab("") + theme_bw()
# fix the y scale to remove padding and fit our label (add 7%)
gg <- gg + scale_y_continuous(expand=c(0,0),
limits=c(0, max(localdf$freq)*1.1))
# make it slightly prettier than the default
gg <- gg + theme(panel.grid.major = element_blank(),
panel.border = element_blank(),
axis.text.x = element_blank(),
axis.ticks = element_blank())
}
oldverisplot <- function(oldvcdb, field) {
# get the data.frame for the field with frequency
localdf <- getenum(oldvcdb, field, add.freq=T)
# now let's take first 5 fields in the data frame.
localdf <- localdf[c(1:5), ]
# add a label to the data.frame
localdf$lab <- paste(round(localdf$freq*100, 0), "%", sep="")
# now we can create a ggplot2 instance
gg <- ggplot(localdf, aes(x=enum, y=freq, label=lab))
gg <- gg + geom_bar(stat="identity", fill="steelblue")
# add in text, adjusted to the end of the bar
gg <- gg + geom_text(hjust=-0.1, size=3)
# flip the axes and add in a title
gg <- gg + coord_flip() + ggtitle(field)
# remove axes labels and add bw theme
gg <- gg + xlab("") + ylab("") + theme_bw()
# fix the y scale to remove padding and fit our label (add 7%)
gg <- gg + scale_y_continuous(expand=c(0,0),
limits=c(0, max(localdf$freq)*1.1))
# make it slightly prettier than the default
gg <- gg + theme(panel.grid.major = element_blank(),
panel.border = element_blank(),
axis.text.x = element_blank(),
axis.ticks = element_blank())
}
newactions <- getenum(newvcdb, "action", add.n=TRUE, add.freq=TRUE)
oldactions <- getenum(oldvcdb, "action", add.n=TRUE, add.freq=TRUE)
enums <- c("Malware", "Hacking", "Social", "Physical", "Misuse", "Error", "Environmental", "Unknown")
values <- round((newactions$freq - oldactions$freq),3)
dtf <- data.frame(x = c(enums), y = c(values))
ggplot(dtf, aes(x, y)) +
geom_bar(stat = "identity", aes(fill = c(1,2,3,4,5,6,7,8))) +
geom_text(aes(label = paste(y * 100, "%"),
vjust = ifelse(y >= 0, 0, 1))
) +
scale_y_continuous("Percentage of change", labels = percent_format()) +
scale_x_discrete("Threat Action", labels=c("Malware", "Hacking", "Social", "Physical", "Misuse", "Error", "Environmental", "Unknown")) +
theme(legend.position="none") +
ggtitle("Change of Actions between 2013 and 2016")
newactions
newCause <- getenum(newvcdb, "actor.external.variety", add.n=TRUE, add.freq=TRUE)
oldCause<- getenum(oldvcdb, "actor.external.variety", add.n=TRUE, add.freq=TRUE)
enums <- c("Acquaintance", "Activist", "Auditor", "Competitor", "Customer", "Force majeure", "Former employee", "Nation-state", "Organized crime", "Other", "State-affiliated", "Terrorist", "Unaffiliated", "Unknown")
values <- round((newasset$freq - oldasset$freq),3)
dtf <- data.frame(x = c(enums), y = c(values))
ggplot(dtf, aes(x, y)) +
geom_bar(stat = "identity", aes(fill = c(1,2,3,4,5,6,7,8,9,10,11,12,13,14))) +
geom_text(aes(label = paste(y * 100, "%"),
vjust = ifelse(y >= 0, 0, 1))
) +
scale_y_continuous("Percentage of change", labels = percent_format()) +
scale_x_discrete("Threat Action", labels=c("Acquaintance", "Activist", "Auditor", "Competitor", "Customer", "Force majeure", "Former employee", "Nation-state", "Organized crime", "Other", "State-affiliated", "Terrorist", "Unaffiliated", "Unknown")) +
theme(legend.position="none", axis.text.x = element_text(angle = -45, hjust = 1)) +
ggtitle("Change of Attackers")
newCause <- getenum(newvcdb, "actor.external.variety", add.n=TRUE, add.freq=TRUE)
oldCause<- getenum(oldvcdb, "actor.external.variety", add.n=TRUE, add.freq=TRUE)
enums <- c("Acquaintance", "Activist", "Auditor", "Competitor", "Customer", "Force majeure", "Former employee", "Nation-state", "Organized crime", "Other", "State-affiliated", "Terrorist", "Unaffiliated", "Unknown")
values <- round((newasset$freq - oldasset$freq),3)
dtf <- data.frame(x = c(enums), y = c(values))
ggplot(dtf, aes(x, y)) +
geom_bar(stat = "identity", aes(fill = c(1,2,3,4,5,6,7,8,9,10,11,12,13,14))) +
geom_text(aes(label = paste(y * 100, "%"),
vjust = ifelse(y >= 0, 0, 1))
) +
scale_y_continuous("Percentage of change", labels = percent_format()) +
scale_x_discrete("Threat Action", labels=c("Acquaintance", "Activist", "Auditor", "Competitor", "Customer", "Force majeure", "Former employee", "Nation-state", "Organized crime", "Other", "State-affiliated", "Terrorist", "Unaffiliated", "Unknown")) +
theme(legend.position="none") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
ggtitle("Change of Attackers")
newCause <- getenum(newvcdb, "actor.external.variety", add.n=TRUE, add.freq=TRUE)
oldCause<- getenum(oldvcdb, "actor.external.variety", add.n=TRUE, add.freq=TRUE)
enums <- c("Acquaintance", "Activist", "Auditor", "Competitor", "Customer", "Force majeure", "Former employee", "Nation-state", "Organized crime", "Other", "State-affiliated", "Terrorist", "Unaffiliated", "Unknown")
values <- round((newasset$freq - oldasset$freq),3)
dtf <- data.frame(x = c(enums), y = c(values))
ggplot(dtf, aes(x, y)) +
geom_bar(stat = "identity", aes(fill = c(1,2,3,4,5,6,7,8,9,10,11,12,13,14))) +
geom_text(aes(label = paste(y * 100, "%"),
vjust = ifelse(y >= 0, 0, 1))
) +
scale_y_continuous("Percentage of change", labels = percent_format()) +
scale_x_discrete("Threat Action", labels=c("Acquaintance", "Activist", "Auditor", "Competitor", "Customer", "Force majeure", "Former employee", "Nation-state", "Organized crime", "Other", "State-affiliated", "Terrorist", "Unaffiliated", "Unknown")) +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
ggtitle("Change of Attackers")
newCause <- getenum(newvcdb, "actor.external.variety", add.n=TRUE, add.freq=TRUE)
oldCause<- getenum(oldvcdb, "actor.external.variety", add.n=TRUE, add.freq=TRUE)
enums <- c("Acquaintance", "Activist", "Auditor", "Competitor", "Customer", "Force majeure", "Former employee", "Nation-state", "Organized crime", "Other", "State-affiliated", "Terrorist", "Unaffiliated", "Unknown")
values <- round((newasset$freq - oldasset$freq),3)
dtf <- data.frame(x = c(enums), y = c(values))
ggplot(dtf, aes(x, y)) +
geom_bar(stat = "identity", aes(fill = c(1,2,3,4,5,6,7,8,9,10,11,12,13,14))) +
geom_text(aes(label = paste(y * 100, "%"),
vjust = ifelse(y >= 0, 0, 1))
) +
scale_y_continuous("Percentage of change", labels = percent_format()) +
scale_x_discrete("Threat Action", labels=c("Acquaintance", "Activist", "Auditor", "Competitor", "Customer", "Force majeure", "Former employee", "Nation-state", "Organized crime", "Other", "State-affiliated", "Terrorist", "Unaffiliated", "Unknown")) +
theme(legend.position="none") +
ggtitle("Change of Attackers between 2013 and 2016")
newCause <- getenum(newvcdb, "actor.external.variety", add.n=TRUE, add.freq=TRUE)
oldCause<- getenum(oldvcdb, "actor.external.variety", add.n=TRUE, add.freq=TRUE)
enums <- c("Acquaintance", "Activist", "Auditor", "Competitor", "Customer", "Force majeure", "Former employee", "Nation-state", "Organized crime", "Other", "State-affiliated", "Terrorist", "Unaffiliated", "Unknown")
values <- round((newasset$freq - oldasset$freq),3)
dtf <- data.frame(x = c(enums), y = c(values))
ggplot(dtf, aes(x, y)) +
geom_bar(stat = "identity", aes(fill = c(1,2,3,4,5,6,7,8,9,10,11,12,13,14))) +
geom_text(aes(label = paste(y * 100, "%"),
vjust = ifelse(y >= 0, 0, 1))
) +
scale_y_continuous("Percentage of change", labels = percent_format()) +
scale_x_discrete("Threat Action", labels=c("Acquaintance", "Activist", "Auditor", "Competitor", "Customer", "Force majeure", "Former employee", "Nation-state", "Organized crime", "Other", "State-affiliated", "Terrorist", "Unaffiliated", "Unknown")) +
theme(legend.position="none") +
ggtitle("Change of Attackers between 2013 and 2016")
newCause <- getenum(newvcdb, "actor.external.variety", add.n=TRUE, add.freq=TRUE)
oldCause<- getenum(oldvcdb, "actor.external.variety", add.n=TRUE, add.freq=TRUE)
enums <- c("Acquaintance", "Activist", "Auditor", "Competitor", "Customer", "Force majeure", "Former employee", "Nation-state", "Organized crime", "Other", "State-affiliated", "Terrorist", "Unaffiliated", "Unknown")
values <- round((newasset$freq - oldasset$freq),3)
dtf <- data.frame(x = c(enums), y = c(values))
ggplot(dtf, aes(x, y)) +
geom_bar(stat = "identity", aes(fill = c(1,2,3,4,5,6,7,8,9,10,11,12,13,14))) +
geom_text(aes(label = paste(y * 100, "%"),
vjust = ifelse(y >= 0, 0, 1))
) +
scale_y_continuous("Percentage of change", labels = percent_format()) +
scale_x_discrete("Threat Action", labels=c("Acquaintance", "Activist", "Auditor", "Competitor", "Customer", "Force majeure", "Former employee", "Nation-state", "Organized crime", "Other", "State-affiliated", "Terrorist", "Unaffiliated", "Unknown")) +
theme(legend.position="none") +
ggtitle("Change of Attackers between 2013 and 2016")
newCause <- getenum(newvcdb, "actor.external.variety", add.n=TRUE, add.freq=TRUE)
oldCause<- getenum(oldvcdb, "actor.external.variety", add.n=TRUE, add.freq=TRUE)
enums <- c("Acquaintance", "Activist", "Auditor", "Competitor", "Customer", "Force majeure", "Former employee", "Nation-state", "Organized crime", "Other", "State-affiliated", "Terrorist", "Unaffiliated", "Unknown")
values <- round((newasset$freq - oldasset$freq),3)
dtf <- data.frame(x = c(enums), y = c(values))
ggplot(dtf, aes(x, y)) +
geom_bar(stat = "identity", aes(fill = c(1,2,3,4,5,6,7,8,9,10,11,12,13,14))) +
geom_text(aes(label = paste(y * 100, "%"),
vjust = ifelse(y >= 0, 0, 1))
) +
scale_y_continuous("Percentage of change", labels = percent_format()) +
scale_x_discrete("Threat Action", labels=c("Acquaintance", "Activist", "Auditor", "Competitor", "Customer", "Force majeure", "Former employee", "Nation-state", "Organized crime", "Other", "State-affiliated", "Terrorist", "Unaffiliated", "Unknown")) +
theme(legend.position="none") +
ggtitle("Change of Attackers between 2013 and 2016")
library(rjson)
library(devtools)
library(verisr)
library(ggplot2)
library(plyr)
library(tidyr)
library(dplyr)
library(scales)
setwd("E:/Documents/School/Winter2016/srt411/assignment1/pt1/")
newjsondir <- 'newData/VCDB-master/data/json'
newvcdb <- json2veris(newjsondir)
oldjsondir <- 'ch07/data/vcdb'
oldvcdb <- json2veris(oldjsondir)
newActors <- getenum(newvcdb, "actor", add.n=TRUE, add.freq=TRUE)
oldActors <- getenum(oldvcdb, "actor", add.n=TRUE, add.freq=TRUE)
oldactors <- getenum(oldvcdb, "actor", add.n=TRUE, add.freq=TRUE)
oldActorsPlot <- barplot(
oldactors$freq*100,
names = oldactors$enum,
col=c("royalblue", "slateblue1", "skyblue1","gold"),
xlab="Source of Attack",
ylab="Percentage",
ylim=range(0:65)
#title(main = "Threat Actors - New Data", font.main = 4)
)
text(x = oldActorsPlot, y = oldactors$freq*100, label = round(oldactors$freq*100,2), pos = 3, cex = 0.8, col = "red")
newactors <- getenum(newvcdb, "actor", add.n=TRUE, add.freq=TRUE)
newActorsPlot <- barplot(
newactors$freq*100,
names = newactors$enum,
col=c("royalblue", "slateblue1", "skyblue1","gold"),
xlab="Source of Attack",
ylab="Percentage",
ylim=range(0:65)
#title(main = "Threat Actors - Old Data", font.main = 4)
)
text(x = newActorsPlot, y = newactors$freq*100, label = round(newactors$freq*100,2), pos = 3, cex = 0.8, col = "red")
newactors$enum
enums <- c("Unknown", "Partner", "Internal", "External")
values <- round((newactors$freq - oldactors$freq),3)
dtf <- data.frame(x = c(enums), y = c(values))
ggplot(dtf, aes(x, y)) +
geom_bar(stat = "identity", aes(fill = c(1,2,3,4))) +
geom_text(aes(label = paste(y * 100, "%"),
vjust = ifelse(y >= 0, 0, 1))
) +
scale_y_continuous("Percentage of change", labels = percent_format()) +
scale_x_discrete("Threat Actor", labels=c("Unknown", "Partner", "Internal", "External")) +
theme(legend.position="none") +
ggtitle("Change of Threat actors between 2013 and 2016")
newVerisplot <- function(newvcdb, field) {
# get the data.frame for the field with frequency
localdf <- getenum(newvcdb, field, add.freq=T)
# now let's take first 5 fields in the data frame.
localdf <- localdf[c(1:5), ]
# add a label to the data.frame
localdf$lab <- paste(round(localdf$freq*100, 0), "%", sep="")
# now we can create a ggplot2 instance
gg <- ggplot(localdf, aes(x=enum, y=freq, label=lab))
gg <- gg + geom_bar(stat="identity", fill="steelblue")
# add in text, adjusted to the end of the bar
gg <- gg + geom_text(hjust=-0.1, size=3)
# flip the axes and add in a title
gg <- gg + coord_flip() + ggtitle(field)
# remove axes labels and add bw theme
gg <- gg + xlab("") + ylab("") + theme_bw()
# fix the y scale to remove padding and fit our label (add 7%)
gg <- gg + scale_y_continuous(expand=c(0,0),
limits=c(0, max(localdf$freq)*1.1))
# make it slightly prettier than the default
gg <- gg + theme(panel.grid.major = element_blank(),
panel.border = element_blank(),
axis.text.x = element_blank(),
axis.ticks = element_blank())
}
print(newVerisplot(newvcdb, "action"))
print(newVerisplot(newvcdb, "actor.external.variety"))
print(newVerisplot(newvcdb, "action.physical.variety"))
print(newVerisplot(newvcdb, "action.hacking.vector"))
print(newVerisplot(newvcdb, "attribute.confidentiality.data.variety"))
print(newVerisplot(newvcdb, "asset.assets"))
oldverisplot <- function(oldvcdb, field) {
# get the data.frame for the field with frequency
localdf <- getenum(oldvcdb, field, add.freq=T)
# now let's take first 5 fields in the data frame.
localdf <- localdf[c(1:5), ]
# add a label to the data.frame
localdf$lab <- paste(round(localdf$freq*100, 0), "%", sep="")
# now we can create a ggplot2 instance
gg <- ggplot(localdf, aes(x=enum, y=freq, label=lab))
gg <- gg + geom_bar(stat="identity", fill="steelblue")
# add in text, adjusted to the end of the bar
gg <- gg + geom_text(hjust=-0.1, size=3)
# flip the axes and add in a title
gg <- gg + coord_flip() + ggtitle(field)
# remove axes labels and add bw theme
gg <- gg + xlab("") + ylab("") + theme_bw()
# fix the y scale to remove padding and fit our label (add 7%)
gg <- gg + scale_y_continuous(expand=c(0,0),
limits=c(0, max(localdf$freq)*1.1))
# make it slightly prettier than the default
gg <- gg + theme(panel.grid.major = element_blank(),
panel.border = element_blank(),
axis.text.x = element_blank(),
axis.ticks = element_blank())
}
print(oldverisplot(oldvcdb, "action"))
print(oldverisplot(oldvcdb, "actor.external.variety"))
print(oldverisplot(oldvcdb, "action.physical.variety"))
print(oldverisplot(oldvcdb, "action.hacking.vector"))
print(oldverisplot(oldvcdb, "attribute.confidentiality.data.variety"))
print(oldverisplot(oldvcdb, "asset.assets"))
#########################
newactions <- getenum(newvcdb, "action", add.n=TRUE, add.freq=TRUE)
oldactions <- getenum(oldvcdb, "action", add.n=TRUE, add.freq=TRUE)
enums <- c("Malware", "Hacking", "Social", "Physical", "Misuse", "Error", "Environmental", "Unknown")
values <- round((newactions$freq - oldactions$freq),3)
dtf <- data.frame(x = c(enums), y = c(values))
ggplot(dtf, aes(x, y)) +
geom_bar(stat = "identity", aes(fill = c(1,2,3,4,5,6,7,8))) +
geom_text(aes(label = paste(y * 100, "%"),
vjust = ifelse(y >= 0, 0, 1))
) +
scale_y_continuous("Percentage of change", labels = percent_format()) +
scale_x_discrete("Threat Action", labels=c("Malware", "Hacking", "Social", "Physical", "Misuse", "Error", "Environmental", "Unknown")) +
theme(legend.position="none") +
ggtitle("Change of Actions between 2013 and 2016")
##################################
newasset <- getenum(newvcdb, "asset.assets", add.n=TRUE, add.freq=TRUE)
oldasset <- getenum(oldvcdb, "asset.assets", add.n=TRUE, add.freq=TRUE)
enums <- c("Server", "Network", "User Dev", "Media", "Person", "Kiosk/Terminal", "Unknown")
values <- round((newasset$freq - oldasset$freq),3)
dtf <- data.frame(x = c(enums), y = c(values))
ggplot(dtf, aes(x, y)) +
geom_bar(stat = "identity", aes(fill = c(1,2,3,4,5,6,7))) +
geom_text(aes(label = paste(y * 100, "%"),
vjust = ifelse(y >= 0, 0, 1))
) +
scale_y_continuous("Percentage of change", labels = percent_format()) +
scale_x_discrete("Threat Action", labels=c("Server", "Network", "User Dev", "Media", "Person", "Kiosk/Terminal", "Unknown")) +
theme(legend.position="none") +
ggtitle("Change of Targets between 2013 and 2016")
##################################
newCause <- getenum(newvcdb, "actor.external.variety", add.n=TRUE, add.freq=TRUE)
oldCause<- getenum(oldvcdb, "actor.external.variety", add.n=TRUE, add.freq=TRUE)
enums <- c("Acquaintance", "Activist", "Auditor", "Competitor", "Customer", "Force majeure", "Former employee", "Nation-state", "Organized crime", "Other", "State-affiliated", "Terrorist", "Unaffiliated", "Unknown")
values <- round((newasset$freq - oldasset$freq),3)
dtf <- data.frame(x = c(enums), y = c(values))
ggplot(dtf, aes(x, y)) +
geom_bar(stat = "identity", aes(fill = c(1,2,3,4,5,6,7,8,9,10,11,12,13,14))) +
geom_text(aes(label = paste(y * 100, "%"),
vjust = ifelse(y >= 0, 0, 1))
) +
scale_y_continuous("Percentage of change", labels = percent_format()) +
scale_x_discrete("Threat Action", labels=c("Acquaintance", "Activist", "Auditor", "Competitor", "Customer", "Force majeure", "Former employee", "Nation-state", "Organized crime", "Other", "State-affiliated", "Terrorist", "Unaffiliated", "Unknown")) +
theme(legend.position="none") +
ggtitle("Change of Attackers between 2013 and 2016")
##################################
newCause <- getenum(newvcdb, "actor.external.variety", add.n=TRUE, add.freq=TRUE)
oldCause<- getenum(oldvcdb, "actor.external.variety", add.n=TRUE, add.freq=TRUE)
enums <- c("Acquaintance", "Activist", "Auditor", "Competitor", "Customer", "Force majeure", "Former employee", "Nation-state", "Organized crime", "Other", "State-affiliated", "Terrorist", "Unaffiliated", "Unknown")
values <- round((newasset$freq - oldasset$freq),3)
dtf <- data.frame(x = c(enums), y = c(values))
ggplot(dtf, aes(x, y)) +
geom_bar(stat = "identity", aes(fill = c(1,2,3,4,5,6,7,8,9,10,11,12,13,14))) +
geom_text(aes(label = paste(y * 100, "%"),
vjust = ifelse(y >= 0, 0, 1))
) +
scale_y_continuous("Percentage of change", labels = percent_format()) +
scale_x_discrete("Threat Action", labels=c("Acquaintance", "Activist", "Auditor", "Competitor", "Customer", "Force majeure", "Former employee", "Nation-state", "Organized crime", "Other", "State-affiliated", "Terrorist", "Unaffiliated", "Unknown")) +
theme(legend.position="none", axis.text.x = element_text(angle = 90, hjust = 1)) +
ggtitle("Change of Attackers between 2013 and 2016")
newCause <- getenum(newvcdb, "actor.external.variety", add.n=TRUE, add.freq=TRUE)
oldCause<- getenum(oldvcdb, "actor.external.variety", add.n=TRUE, add.freq=TRUE)
enums <- c("Acquaintance", "Activist", "Auditor", "Competitor", "Customer", "Force majeure", "Former employee", "Nation-state", "Organized crime", "Other", "State-affiliated", "Terrorist", "Unaffiliated", "Unknown")
values <- round((newasset$freq - oldasset$freq),3)
dtf <- data.frame(x = c(enums), y = c(values))
ggplot(dtf, aes(x, y)) +
geom_bar(stat = "identity", aes(fill = c(1,2,3,4,5,6,7,8,9,10,11,12,13,14))) +
geom_text(aes(label = paste(y * 100, "%"),
vjust = ifelse(y >= 0, 0, 1))
) +
scale_y_continuous("Percentage of change", labels = percent_format()) +
scale_x_discrete("Threat Action", labels=c("Acquaintance", "Activist", "Auditor", "Competitor", "Customer", "Force majeure", "Former employee", "Nation-state", "Organized crime", "Other", "State-affiliated", "Terrorist", "Unaffiliated", "Unknown")) +
theme(legend.position="none", axis.text.x = element_text(angle = 45, hjust = 1)) +
ggtitle("Change of Attackers between 2013 and 2016")
newCause <- getenum(newvcdb, "actor.external.variety", add.n=TRUE, add.freq=TRUE)
oldCause<- getenum(oldvcdb, "actor.external.variety", add.n=TRUE, add.freq=TRUE)
enums <- c("Acquaintance", "Activist", "Auditor", "Competitor", "Customer", "Force majeure", "Former employee", "Nation-state", "Organized crime", "Other", "State-affiliated", "Terrorist", "Unaffiliated", "Unknown")
values <- round((newasset$freq - oldasset$freq),3)
dtf <- data.frame(x = c(enums), y = c(values))
ggplot(dtf, aes(x, y)) +
geom_bar(stat = "identity", aes(fill = c(1,2,3,4,5,6,7,8,9,10,11,12,13,14))) +
geom_text(aes(label = paste(y * 100, "%"),
vjust = ifelse(y >= 0, 0, 1))
) +
scale_y_continuous("Percentage of change", labels = percent_format()) +
scale_x_discrete("Threat Action", labels=c("Acquaintance", "Activist", "Auditor", "Competitor", "Customer", "Force majeure", "Former employee", "Nation-state", "Organized crime", "Other", "State-affiliated", "Terrorist", "Unaffiliated", "Unknown")) +
theme(legend.position="none", axis.text.x = element_text(angle = 20, hjust = 1)) +
ggtitle("Change of Attackers between 2013 and 2016")
newCause <- getenum(newvcdb, "actor.external.variety", add.n=TRUE, add.freq=TRUE)
oldCause<- getenum(oldvcdb, "actor.external.variety", add.n=TRUE, add.freq=TRUE)
enums <- c("Acquaintance", "Activist", "Auditor", "Competitor", "Customer", "Force majeure", "Former employee", "Nation-state", "Organized crime", "Other", "State-affiliated", "Terrorist", "Unaffiliated", "Unknown")
values <- round((newasset$freq - oldasset$freq),3)
dtf <- data.frame(x = c(enums), y = c(values))
ggplot(dtf, aes(x, y)) +
geom_bar(stat = "identity", aes(fill = c(1,2,3,4,5,6,7,8,9,10,11,12,13,14))) +
geom_text(aes(label = paste(y * 100, "%"),
vjust = ifelse(y >= 0, 0, 1))
) +
scale_y_continuous("Percentage of change", labels = percent_format()) +
scale_x_discrete("Threat Action", labels=c("Acquaintance", "Activist", "Auditor", "Competitor", "Customer", "Force majeure", "Former employee", "Nation-state", "Organized crime", "Other", "State-affiliated", "Terrorist", "Unaffiliated", "Unknown")) +
theme(legend.position="none", axis.text.x = element_text(angle = 35, hjust = 1)) +
ggtitle("Change of Attackers between 2013 and 2016")
newCause <- getenum(newvcdb, "actor.external.variety", add.n=TRUE, add.freq=TRUE)
oldCause<- getenum(oldvcdb, "actor.external.variety", add.n=TRUE, add.freq=TRUE)
enums <- c("Acquaintance", "Activist", "Auditor", "Competitor", "Customer", "Force majeure", "Former employee", "Nation-state", "Organized crime", "Other", "State-affiliated", "Terrorist", "Unaffiliated", "Unknown")
values <- round((newasset$freq - oldasset$freq),3)
dtf <- data.frame(x = c(enums), y = c(values))
ggplot(dtf, aes(x, y)) +
geom_bar(stat = "identity", aes(fill = c(1,2,3,4,5,6,7,8,9,10,11,12,13,14))) +
geom_text(aes(label = paste(y * 100, "%"),
vjust = ifelse(y >= 0, 0, 1))
) +
scale_y_continuous("Percentage of change", labels = percent_format()) +
scale_x_discrete("Threat Action", labels=c("Acquaintance", "Activist", "Auditor", "Competitor", "Customer", "Force majeure", "Former employee", "Nation-state", "Organized crime", "Other", "State-affiliated", "Terrorist", "Unaffiliated", "Unknown")) +
theme(legend.position="none", axis.text.x = element_text(angle = 35, hjust = 1)) +
ggtitle("Change of Attackers")
options(warn=-1)
options(warn=-1)
rcp_tn <- read.csv('packets.csv', header = TRUE)
rcp_tn <- read.csv('packets.csv', header = TRUE)
setwd('E:/Documents/School/Winter2016/srt411/assignment1/pt3')
rcp_tn <- read.csv('packets.csv', header = TRUE)
rcp_tn <- read.csv('packets.csv', header = TRUE)
rcp_tn <- read.csv('rpcLess.csv', header = TRUE)
ggplot(rcp_tn, aes(Source, Protocol)) +
geom_jitter() +
ylab("Protocol Used") +
xlab("Source IP") +
ggtitle("Mapping Source IP against Protocol")  +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
rcp_tn <- read.csv('packets.csv', header = TRUE)
attack <- getenum(packets, 'Protocol', add.n=TRUE, add.freq=TRUE)
ggplot(attack, aes(enum, x, group = 1, colour = x)) +
geom_line(size=2.5) +
geom_point(size=8) +
stat_smooth(level=0.5) +
scale_colour_gradient(high="red", low="blue") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
attack <- getenum(packets, 'Protocol', add.n=TRUE, add.freq=TRUE)
rcp_tn <- read.csv('rpcLess.csv', header = TRUE)
ggplot(rcp_tn, aes(Source, Protocol)) +
geom_jitter() +
ylab("Protocol Used") +
xlab("Source IP") +
ggtitle("Mapping Source IP against Protocol")
#theme(axis.text.x = element_text(angle = 90, hjust = 1))
rcp_tn <- read.csv('packets', header = TRUE)
rcp_tn <- read.csv('packets', header = TRUE)
rcp_tn
summary(rcp_tn)
attack
attack <- getenum(rcp_tn, 'Protocol', add.n=TRUE, add.freq=TRUE)
attack
ggplot(attack, aes(enum, x, group = 1, colour = x)) +
geom_line(size=2.5) +
geom_point(size=8) +
stat_smooth(level=0.5) +
scale_colour_gradient(high="red", low="blue") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
newCause <- getenum(newvcdb, "actor.external.variety", add.n=TRUE, add.freq=TRUE)
oldCause<- getenum(oldvcdb, "actor.external.variety", add.n=TRUE, add.freq=TRUE)
enums <- c("Acquaintance", "Activist", "Auditor", "Competitor", "Customer", "Force majeure", "Former employee", "Nation-state", "Organized crime", "Other", "State-affiliated", "Terrorist", "Unaffiliated", "Unknown")
values <- round((newasset$freq - oldasset$freq),3)
dtf <- data.frame(x = c(enums), y = c(values))
ggplot(dtf, aes(x, y)) +
geom_bar(stat = "identity", aes(fill = c(1,2,3,4,5,6,7,8,9,10,11,12,13,14))) +
geom_text(aes(label = paste(y * 100, "%"),
vjust = ifelse(y >= 0, 0, 1))
) +
scale_y_continuous("Percentage of change", labels = percent_format()) +
scale_x_discrete("Threat Action", labels=c("Acquaintance", "Activist", "Auditor", "Competitor", "Customer", "Force majeure", "Former employee", "Nation-state", "Organized crime", "Other", "State-affiliated", "Terrorist", "Unaffiliated", "Unknown")) +
theme(legend.position="none", axis.text.x = element_text(angle = 35, hjust = 1)) +
ggtitle("Change of Attackers between 2013 and 2016")
setwd('E:/Documents/School/Winter2016/srt411/assignment1/pt3')
rcp_tn <- read.csv('packets', header = TRUE)
attack <- getenum(rcp_tn, 'Protocol', add.n=TRUE, add.freq=TRUE)
ggplot(attack, aes(enum, x, group = 1, colour = x)) +
geom_line(size=2.5) +
geom_point(size=8) +
stat_smooth(level=0.5) +
scale_colour_gradient(high="red", low="blue") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
attack <- getenum(packets, 'Protocol', add.n=TRUE, add.freq=TRUE)
ggplot(attack, aes(enum, x, group = 1, colour = x)) +
geom_line(size=2.5) +
geom_point(size=8) +
stat_smooth(level=0.5) +
scale_colour_gradient(high="red", low="blue") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(rcp_tn, aes(Source, Protocol)) +
geom_jitter() +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
rpc_less <- select(rpcLess, Source, Destination, Length)
rpcScan <- subset(rpcLess, (Length < 1400))
newRpc <- select(rpc_filtered, Length < 1400)
parallelplot(~newRpc[1:3] | Protocol, rpcScan)
